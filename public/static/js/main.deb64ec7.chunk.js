(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(19),l=a.n(c),o=(a(85),a(47)),s=a(8),i=a(29),u=a(32),m=a(33),p=a(57),d=(a(92),a(41)),f=a(11),h=function(e){return{type:"ADD_TOKEN",token:e}},E=function(e){return{type:"ADD_LOGIN_ERROR",loginError:e}},g={token:null,loginError:!1},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TOKEN":return Object(f.a)(Object(f.a)({},e),{},{token:t.token});case"ADD_LOGIN_ERROR":return Object(f.a)(Object(f.a)({},e),{},{loginError:t.loginError});default:return e}},b=Object(d.b)(v),y=a(6),w=a.n(y),O=a(10),j=a(7),k=a(121),x=a(122),N=a(117),C=a(118),S=a(119),I=a(26),L=function(e){var t=Object(n.useState)([]),a=Object(j.a)(t,2),c=a[0],l=a[1],i=Object(n.useState)(""),u=Object(j.a)(i,2),m=u[0],p=u[1],d=Object(n.useState)(0),h=Object(j.a)(d,2),E=h[0],g=h[1],v=Object(n.useState)({}),b=Object(j.a)(v,2),y=b[0],L=b[1],P=Object(n.useState)([]),D=Object(j.a)(P,2),R=D[0],T=D[1],F=Object(n.useState)(!1),_=Object(j.a)(F,2),A=_[0],G=_[1],J=Object(n.useState)(!1),B=Object(j.a)(J,2),H=B[0],V=B[1],Y=Object(n.useState)(!1),q=Object(j.a)(Y,2),K=q[0],M=q[1],W=Object(n.useState)(!1),$=Object(j.a)(W,2),z=$[0],Q=$[1],U=Object(n.useState)([!1,!1,!1,!1,!1]),X=Object(j.a)(U,2),Z=X[0],ee=X[1],te=Object(n.useState)({item:{name:"",itemCategory:{name:"",points:0}},user:{userId:""},rating:0}),ae=Object(j.a)(te,2),ne=ae[0],re=ae[1],ce=function(){var e,t,a,n,r,c,l,o,s,i=(null===ne||void 0===ne||null===(e=ne.item)||void 0===e||null===(t=e.name)||void 0===t||null===(a=t.trim())||void 0===a?void 0:a.length)>0,u=Z.filter((function(e){return!0===e})).length>0,m=(null===ne||void 0===ne||null===(n=ne.item)||void 0===n||null===(r=n.itemCategory)||void 0===r||null===(c=r.name)||void 0===c||null===(l=c.trim())||void 0===l?void 0:l.length)>0&&(null===ne||void 0===ne||null===(o=ne.item)||void 0===o||null===(s=o.itemCategory)||void 0===s?void 0:s.points)>0;return i&&m&&u},le=function(e){var t=[!1,!1,!1,!1,!1];return t.forEach((function(a,n){t[n]=n<=e})),ee(t)},oe=function(e){return Z[e]?"rating-star checked-star":"rating-star"},se=function(e){var t=e.target,a=t.name,n=t.value,r=Object(f.a)({},ne);"itemCategory"===a?r.item.itemCategory=R.find((function(e){return e._id===JSON.parse(n)._id})):"name"===a&&(r.item.name=n),console.log(r),re(Object(f.a)(Object(f.a)({},ne),r))},ie=function(){V(!1),ee([!1,!1,!1,!1,!1]),re({item:{name:"",itemCategory:{name:"",points:0}},user:{userId:""},rating:0})},ue=function(){var e=Object(O.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(ne),t={item:{name:ne.item.name,itemCategory:{name:ne.item.itemCategory.name,points:ne.item.itemCategory.points}},rating:Z.filter((function(e){return!0===e})).length},e.prev=2,e.next=5,fetch("http://localhost:5000/api/entries",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",token:pe},body:JSON.stringify(t)});case 5:M(!0),setTimeout((function(){return M(!1)}),1e4),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),Q(!0),setTimeout((function(){return Q(!1)}),1e4);case 14:ie(),ge();case 16:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),me=function(){return V(!0)},pe=sessionStorage.getItem("token"),de=function(){var e=sessionStorage.getItem("token");return e&&"undefined"!==e?null:r.a.createElement(s.a,{to:"/login"})},fe=function(e){switch(e){case"Manga Volume":return"atlas";case"Book":return"book";case"Film":return"film";case"Video Game":return"gamepad";case"Sport":return"trophy";case"TV Show":return"tv";default:return null}},he=function(e){for(var t=[],a=0;a<e;a++)t.push(r.a.createElement(I.a,{key:a,className:"checked-star",icon:"star"}));return t},Ee=function(){var e=Object(O.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("Are you sure you want to delete this entry?"))try{fetch("http://localhost:5000/api/entries/".concat(t),{method:"DELETE",headers:{token:pe}}),G(!0),setTimeout(Object(O.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge();case 2:G(!1);case 3:case"end":return e.stop()}}),e)}))),100)}catch(a){console.log(a)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=Object(O.a)(w.a.mark((function e(){var t,a,n,c,s,i,u;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5000/api/entries",{headers:{token:pe}});case 3:return t=e.sent,e.next=6,t.json();case 6:return(u=e.sent).entries=null===u||void 0===u||null===(a=u.entries)||void 0===a?void 0:a.filter((function(e){return(null===e||void 0===e?void 0:e.year)===(new Date).getFullYear().toString()})),g(null===u||void 0===u||null===(n=u.entries)||void 0===n?void 0:n.length),p(null===(c=Object(o.a)(u.entries))||void 0===c||null===(s=c.sort((function(e,t){return parseFloat(null===t||void 0===t?void 0:t.rating)-parseFloat(null===e||void 0===e?void 0:e.rating)}))[0])||void 0===s||null===(i=s.item)||void 0===i?void 0:i.name),e.next=12,l((null===u||void 0===u?void 0:u.entries)&&(null===u||void 0===u?void 0:u.entries.length)?r.a.createElement(S.a,{striped:!0,hover:!0,responsive:"true"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Category"),r.a.createElement("th",null,"Rating"),r.a.createElement("th",null,"Points"),r.a.createElement("th",null,"Year"),r.a.createElement("th",null,"Delete"))),r.a.createElement("tbody",null,null===u||void 0===u?void 0:u.entries.sort((function(e,t){return e.date-t.date})).map((function(e,t){return r.a.createElement("tr",{key:e._id},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.item.name),r.a.createElement("td",null,r.a.createElement(I.a,{icon:fe(e.item.itemCategory.name)})," ",e.item.itemCategory.name),r.a.createElement("td",null,he(e.rating)),r.a.createElement("td",null,e.item.itemCategory.points),r.a.createElement("td",null,e.year),r.a.createElement("td",null,r.a.createElement(I.a,{className:"delete-icon",icon:"trash",onClick:function(){return Ee(e._id)}})))})).reverse())):r.a.createElement("p",null,"No entries logged yet!"));case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0),de();case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){function e(){return t.apply(this,arguments)}function t(){return(t=Object(O.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ge();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function a(){return n.apply(this,arguments)}function n(){return(n=Object(O.a)(w.a.mark((function e(){var t,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5000/api/users/current",{headers:{token:pe}});case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,L(a.user),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function r(){return c.apply(this,arguments)}function c(){return(c=Object(O.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5000/api/item-categories",{headers:{token:pe}});case 3:return t=e.sent,e.next=6,t.json();case 6:t=e.sent,T(t.itemCategories),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}(function(){var t=Object(O.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return G(!0),t.next=3,r();case 3:return t.next=5,a();case 5:return t.next=7,e();case 7:G(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[pe]),r.a.createElement("div",{className:"entries"},de(),A?r.a.createElement("div",{className:"d-flex justify-content-center"},r.a.createElement("br",null),r.a.createElement(C.a,{as:"span",animation:"grow",style:{width:"5em",height:"5rem"},role:"status","aria-hidden":"true",className:"loader"})):r.a.createElement(r.a.Fragment,null,K?r.a.createElement("span",{className:"text-success"},r.a.createElement("br",null),"New entry logged successfully."):null,z?r.a.createElement("span",{className:"text-danger"},r.a.createElement("br",null),"New entry attempt failed, please try again."):null,r.a.createElement("br",null),r.a.createElement(k.a,{show:H,onHide:ie},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Log A New Entry!")),r.a.createElement(k.a.Body,null,r.a.createElement(x.a,null,r.a.createElement(x.a.Group,{controlId:"itemName"},r.a.createElement(x.a.Label,null,"Name *"),r.a.createElement(x.a.Control,{name:"name",value:ne.item.name,type:"text",placeholder:"Enter a name for your entry",onChange:se})),r.a.createElement(x.a.Group,{controlId:"itemCategory"},r.a.createElement(x.a.Label,null,"Category *"),r.a.createElement(x.a.Control,{name:"itemCategory",as:"select",onChange:se,value:JSON.stringify(ne.item.itemCategory)},r.a.createElement("option",{value:JSON.stringify({name:"",points:0}),disabled:!0},"Please select a category for your entry"),R?R.map((function(e){return r.a.createElement("option",{key:e._id,value:JSON.stringify(e)},e.name)})):de())),r.a.createElement(x.a.Group,{controlId:"rating"},r.a.createElement(x.a.Label,null,"Rating *"),r.a.createElement("br",null),r.a.createElement(I.a,{onClick:function(){return le(0)},className:oe(0),icon:"star"}),r.a.createElement(I.a,{onClick:function(){return le(1)},className:oe(1),icon:"star"}),r.a.createElement(I.a,{onClick:function(){return le(2)},className:oe(2),icon:"star"}),r.a.createElement(I.a,{onClick:function(){return le(3)},className:oe(3),icon:"star"}),r.a.createElement(I.a,{onClick:function(){return le(4)},className:oe(4),icon:"star"})),r.a.createElement(x.a.Text,{className:"text-muted"},"* required"))),r.a.createElement(k.a.Footer,null,r.a.createElement(N.a,{variant:"secondary",onClick:ie},"Cancel"),r.a.createElement(N.a,{variant:"success",onClick:ue,disabled:!ce()},"Log Entry"))),r.a.createElement("h3",null,"Summary"),r.a.createElement("p",null,"In ",r.a.createElement("b",null,(new Date).getFullYear())," so far, ",r.a.createElement("b",null,null===y||void 0===y?void 0:y.name)," has"," ",r.a.createElement("b",null,null===y||void 0===y?void 0:y.points)," points from ",r.a.createElement("b",null,E," "),"entries, the highest rated entry is ",r.a.createElement("b",null,m),"."),r.a.createElement("div",null,r.a.createElement(N.a,{variant:"primary",onClick:me},"Log New Entry"),r.a.createElement("br",null),r.a.createElement("br",null)),r.a.createElement("div",null,c)))},P=a(30),D=a.n(P),R=function(e){var t=Object(n.useState)(""),a=Object(j.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(""),s=Object(j.a)(o,2),m=s[0],p=s[1],d=Object(n.useState)(!1),f=Object(j.a)(d,2),g=f[0],v=f[1],y=Object(n.useState)(""),k=Object(j.a)(y,2),x=k[0],N=k[1];Object(u.b)((function(e){g!==e.loginError&&v(e.loginError)}));var C=function(){var t=Object(O.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:D.a.post("http://localhost:5000/auth/local",{name:c,password:m}).then((function(t){t.data&&(b.dispatch(E(!1)),b.dispatch(h(t.data.token)),sessionStorage.setItem("token",t.data.token),e.history.push("/entries"))})).catch((function(e){b.dispatch(E(!0)),N(e.response.data.message),p("")}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"login"},r.a.createElement("br",null),r.a.createElement("h3",null,"Login"),r.a.createElement("form",{onSubmit:function(e){C(),e.preventDefault()}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Name"),r.a.createElement("input",{type:"name",className:"form-control",id:"name","aria-describedby":"nameHelp",placeholder:"Enter name",value:c,onChange:function(e){return l(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"password",placeholder:"Password",value:m,onChange:function(e){return p(e.target.value)}})),r.a.createElement("button",{type:"submit",className:"btn btn-success",disabled:!c||!m},"Submit"),g?r.a.createElement("div",{className:"text-danger"},r.a.createElement("br",null),x):null),r.a.createElement("p",null,r.a.createElement("br",null),r.a.createElement(i.b,{className:"text-muted",to:"/register"},"Don't have an account yet?")))},T=a(124),F=a(120),_=a(123),A=a(76),G=a.n(A),J=function(e){var t=Object(n.useState)(b.getState().token),a=Object(j.a)(t,2),c=a[0],l=a[1];return Object(u.b)((function(e){c!==e.token&&l(e.token)})),r.a.createElement(T.a,{bg:"primary",variant:"dark",expand:"md"},r.a.createElement(T.a.Brand,{href:"/"},r.a.createElement(F.a,{style:{width:"1.5em",marginRight:"0.5em"},src:G.a,rounded:!0}),"Entertainment Tracker"),r.a.createElement(T.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(T.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(_.a,{className:"mr-auto"},c?r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a.Link,{href:"/entries"},"Entries"),r.a.createElement(_.a.Link,{href:"/logout"},"Logout")):r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a.Link,{href:"/login"},"Login"),r.a.createElement(_.a.Link,{href:"/register"},"Register")))))},B=function(e){var t=function(){var e=Object(O.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.a.get("http://localhost:5000/auth/logout",{headers:{token:b.getState().token}});case 3:sessionStorage.removeItem("token"),b.dispatch(h(null)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){(function(){var e=Object(O.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement("div",null," ")},H=function(e){var t=Object(n.useState)({name:"",password:"",retypePassword:""}),a=Object(j.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(""),s=Object(j.a)(o,2),u=s[0],m=s[1],p=function(e){var t=e.target,a=t.name,n=t.value,r=Object(f.a)({},c);"name"===a?r.name=n:"password"===a?r.password=n:"retypePassword"===a&&(r.retypePassword=n),l(Object(f.a)(Object(f.a)({},c),r))},d=function(){var t=Object(O.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",D.a.post("http://localhost:5000/auth/local",{name:c.name,password:c.password}).then((function(t){t.data&&(b.dispatch(h(t.data.token)),sessionStorage.setItem("token",t.data.token),l({name:"",password:"",retypePassword:""}),e.history.push("/entries"))})).catch((function(e){l(Object(f.a)(Object(f.a)({},c),{},{password:"",retypePassword:""}))})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),E=function(){var e=Object(O.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D.a.post("http://localhost:5000/api/users",{body:{name:c.name,password:c.password}}).then((function(e){e.data&&d()})).catch((function(e){m(e.response.data.message),l({name:"",password:"",retypePassword:""})}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"register"},r.a.createElement("br",null),r.a.createElement("h3",null,"Register"),r.a.createElement(x.a,null,r.a.createElement(x.a.Group,{controlId:"registerName"},r.a.createElement(x.a.Label,null,"Name *"),r.a.createElement(x.a.Control,{name:"name",value:c.name,type:"text",placeholder:"Enter a name for your account",onChange:p})),r.a.createElement(x.a.Group,{controlId:"registerPassword"},r.a.createElement(x.a.Label,null,"Password *"),r.a.createElement(x.a.Control,{name:"password",value:c.password,type:"password",placeholder:"Enter a password for your account",onChange:p})),r.a.createElement(x.a.Group,{controlId:"registerRetypePassword"},r.a.createElement(x.a.Label,null,"Retype Password *"),r.a.createElement(x.a.Control,{name:"retypePassword",value:c.retypePassword,type:"password",placeholder:"Retype the password for your account",onChange:p})),r.a.createElement(N.a,{onClick:function(e){E(),e.preventDefault()},variant:"success",type:"submit",disabled:!(c.name.trim().length>0&&c.password.trim().length>0&&c.retypePassword.trim().length&&c.password===c.retypePassword)},"Submit"),r.a.createElement(x.a.Text,{className:"text-muted"},"* required"),u?r.a.createElement("span",{className:"text-danger"},r.a.createElement("br",null),u):null),r.a.createElement("p",null,r.a.createElement("br",null),r.a.createElement(i.b,{className:"text-muted",to:"/login"},"Already have an account?")))},V=Object.keys(p).filter((function(e){return"fas"!==e&&"prefix"!==e})).map((function(e){return p[e]}));m.b.add.apply(m.b,Object(o.a)(V));var Y=function(){var e="undefined"!==sessionStorage.getItem("token")&&sessionStorage.getItem("token")?sessionStorage.getItem("token"):null;b.dispatch(h(e));return r.a.createElement(u.a,{store:b},r.a.createElement(i.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("br",null),r.a.createElement("div",{className:"container"},r.a.createElement(J,null),e?r.a.createElement(s.a,{to:"/entries"}):null,r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:function(){return e?r.a.createElement(L,null," "):r.a.createElement(R,null)}}),r.a.createElement(s.b,{exact:!0,path:"/login",component:R}),r.a.createElement(s.b,{exact:!0,path:"/register",component:H}),r.a.createElement(s.b,{exact:!0,path:"/logout",component:B}),r.a.createElement(s.b,{exact:!0,path:"/entries",component:L}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},76:function(e,t,a){e.exports=a.p+"static/media/scroll.5660ca10.png"},80:function(e,t,a){e.exports=a(115)},85:function(e,t,a){},92:function(e,t,a){}},[[80,1,2]]]);
//# sourceMappingURL=main.deb64ec7.chunk.js.map